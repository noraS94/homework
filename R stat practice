library(palmerpenguins)

#default histogram
hist(penguins$body_mass_g)

#define vectors
hist(penguins$body_mass_g, breaks = seq(8000))

#bar chart, need to define table first!
barplot(table(penguins$species))

#defeult plot is bar plot
plot(penguins$species)

#contingency table

#addmargins adds sums
species_count <- table(penguins$species, penguins$island)
addmargins(species_count)

barplot(species_count)

#ggplot

library(tidyverse)
#aes means aesthetics, "x =" defining x axis, "geom_" defines type of graph
#mapping not required if order stays the same
ggplot(penguins, mapping = aes(x = body_mass_g)) +
  geom_histogram()

#tweaking
ggplot(penguins, mapping = aes(x = body_mass_g)) +
  geom_histogram(binwidth = 500, alpha = 0.5,
                 color = "dark blue", fill = "light blue") +
  labs(title = "histogram practice", caption = "penguin dataset",
       x = "body mass in g", y = "count") + 
  theme_light()

#second mapping, dodge means no overlap anymore, the 3 bars "dodge" eachother
ggplot(penguins, aes(x = body_mass_g, fill = species)) +
  geom_histogram(position = "dodge") + theme_dark()

#separate histograms for each species using faceting
ggplot(penguins, aes(x = body_mass_g)) +
  geom_histogram() + facet_wrap(~species) + theme_classic()

#bar charts
ggplot(penguins, aes(x = island)) +
  geom_bar()

ggplot(penguins, aes(x = island, fill = species)) + geom_bar() +
  facet_wrap(~sex) + scale_fill_brewer(type = "seq", palette = "Spectral")

#box plots
ggplot(penguins, aes(y = body_mass_g)) + geom_boxplot()

ggplot(drop_na(penguins), aes(x = species, y = body_mass_g, color = sex)) + 
  geom_boxplot() + 
  geom_point(position = position_jitterdodge(jitter.width=0.2), alpha = 0.2)

#Scatter plots, this one with linear trend line
ggplot(penguins, aes(x = body_mass_g, y = flipper_length_mm)) + geom_point() +
  geom_smooth(method = "lm")

#no more trendline, we will do this later
ggplot(penguins, aes(x = body_mass_g, y = flipper_length_mm, color = species)) +
  geom_point() + scale_color_brewer(type = "seq", palette = "Dark2")

#with color gradient and different shapes according to sex
ggplot(penguins, aes(x = body_mass_g, y = flipper_length_mm, color = bill_depth_mm, shape = sex)) +
  geom_point(size = 1, alpha = 0.5) + scale_color_distiller(palette = "YlGnBu")

#plot practice with iris dataset
ggplot(drop_na(iris), aes(x = Petal.Length, y = Petal.Width, color = Species)) +
  geom_point(size = 3, alpha = 2) + scale_color_brewer(type = "seq", palette= "Dark2") +
  labs(title = "Petal width and sepal length in different Iris species", caption = "Iris dataset",
      x = "Petal length", y = "Petal width")

#penguins dataset
summarise(group_by(penguins, species, island),
          across(where(is.numeric), mean, na.rm = T))
# |> pipe operation, "this then that"
penguins |> group_by(species) |> count(sex) |> mutate(frequency = n/sum(n) )

